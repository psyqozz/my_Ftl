/*
** ETNA PROJECT, 12/11/2018 by juzain_d
** secondary fonction
** File description:
**      ...
*/

#include "ftl.h"

void lost_energy(ship_t *ship)
{
    ship->drive->energy = ship->drive->energy - 1;
    my_putstr_color("red","[WARNING]: We lost energy!\n");
}

char *init_bonus()
{
    srandom(time(NULL));
    char *result;
    int nb_rand;
    nb_rand = (random() % 100);
    if (nb_rand <= 70)
        result = "scrap";
    else {
        if (nb_rand < 33)
            result = "energy";
        else if (nb_rand < 66)
            result = "attackbonus";
        else if (nb_rand < 99)
            result = "evadebonus";
        else
            result = "scrap";
    }
    return (result);
}

int create_bonus(ship_t *ship)
{
    int i = 0;
    freight_t *frei[10];
    int good_size = 1;
    while (i < 10) {
        frei[i] = NULL;
        if ((frei[i] = malloc(sizeof(freight_t))) == NULL)
            good_size = 0;
        else {
            frei[i]->item = my_strdup(init_bonus());
            add_freight_to_container(ship, frei[i]);
        }
        i++;
    }
    return (good_size);
}

void if_exist_bonus(ship_t *ship)
{
    if (create_bonus(ship) == 0) {
        my_putstr_color("red", "error during the detection\n");
        ship->navigation_tools->detect = 2;
    }
}
